# utils/string_utils.py
import re
from typing import List, Set, Dict

def extract_iocs(text: str) -> Dict[str, List[str]]:

    iocs = {
        'ips': set(),
        'domains': set(),
        'urls': set(),
        'emails': set(),
        'md5s': set(),
        'sha1s': set(),
        'sha256s': set()
    }
    

    ip_pattern = r'\b(?:\d{1,3}\.){3}\d{1,3}\b'
    iocs['ips'].update(re.findall(ip_pattern, text))
    

    domain_pattern = r'\b(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}\b'
    iocs['domains'].update(re.findall(domain_pattern, text))
    

    url_pattern = r'https?://(?:[-\w.]|(?:%[\da-fA-F]{2}))+'
    iocs['urls'].update(re.findall(url_pattern, text))
    

    email_pattern = r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
    iocs['emails'].update(re.findall(email_pattern, text))
    

    md5_pattern = r'\b[a-fA-F0-9]{32}\b'
    sha1_pattern = r'\b[a-fA-F0-9]{40}\b'
    sha256_pattern = r'\b[a-fA-F0-9]{64}\b'
    
    iocs['md5s'].update(re.findall(md5_pattern, text))
    iocs['sha1s'].update(re.findall(sha1_pattern, text))
    iocs['sha256s'].update(re.findall(sha256_pattern, text))
    

    return {k: list(v) for k, v in iocs.items()}